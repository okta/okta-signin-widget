// Helper functions for interacting with package information for internal CI.
'use strict';

var path = require('path'),
    DEFAULT_REGISTRY_URLBASE = 'https://artifacts.aue1d.saasure.com/artifactory';

module.exports = function (pkg) {

  function fullversion() {
    return pkg.okta.fullVersion;
  }

  function pkgsemver() {
    return pkg.version;
  }

  function pkgname() {
    return pkg.name;
  }

  function getRegistryUrlBase() {
    if (process.env.REGISTRY_URLBASE === undefined) {
      return DEFAULT_REGISTRY_URLBASE;
    }
    return process.env.REGISTRY_URLBASE;
  }

  function dataload() {
    var registryUrlBase = getRegistryUrlBase(),
        artifact = pkgname() + '-' + pkgsemver() + '.tgz',
        query = '?properties=buildVersion=' + fullversion();
    return registryUrlBase + path.join(
      '/api/storage/npm-okta',
      pkgname(),
      '-',
      artifact + query
    );
  }

  return {
    fullversion : fullversion,
    dataload : dataload,
    pkgsemver : pkgsemver,
    pkgname : pkgname
  };

};
