define([
  'shared/views/BaseView'
], function (BaseView) {

  return BaseView.extend({

    className: 'username-default',

    events: {
      'click .override-mapping': function (e) {
        e.preventDefault();
        this.$el.hide();
      }
    },

    template: '\
      <p>Username is set by \
      {{#if showLink}}\
        <a href="/admin/app/{{name}}/instance/{{id}}/#{{tab}}" target="_blank"> {{label}}</a>\
        {{#if allowOverride}}\
          &nbsp;&middot;&nbsp;\
          <a href="#" class="override-mapping">Override with mapping</a>\
        {{/if}}\
      {{else}}\
        {{label}}\
      {{/if}}\
      </p>\
    ',

    getTemplateData: function () {
      var tab = 'tab-signon',
          appName = this.model.get('name'),
          allowOverride= !this.settings.hasFeature('CONSOLIDATE_USERNAME_EL')
            || appName === 'saml_idp';

      if (appName === 'active_directory') {
        tab = 'tab-general';
      } else if (this.state.get('tabId') === 'appToOkta') {
        tab = 'tab-user-management';
      }

      return {
        id: this.model.get('id'),
        label: this.model.get('label'),
        name: this.model.get('name'),
        allowOverride: allowOverride,
        tab: tab,
        showLink: !this.options.previewModel.get('userId')
      };
    }

  });
});
