define([
  'shared/views/BaseView',
  'shared/util/TemplateUtil'
], function (BaseView, TemplateUtil) {

  function toggleClass() {
    this.$el.toggleClass('ui-state-active ui-tabs-selected', this.isActive);
  }

  var tpl = TemplateUtil.tpl('<a href="{{link}}" id="{{id}}">{{{disp}}}</a>');

  return BaseView.extend({

    tagName: 'li',
    className: 'ui-state-default ui-corner-top',

    initialize: function (options) {
      this.isActive = options.selected;
      this.template = tpl({id: options.id, disp: options.disp, link: options.link});
      this.listenTo(this.state, 'change:tabId', function () {
        this.isActive = this.state.get('tabId') === options.id;
        toggleClass.call(this);
      });
    },

    render: function () {
      BaseView.prototype.render.apply(this, arguments);
      toggleClass.call(this);
      return this;
    }

  });
});
