define([
  'underscore',
  'shared/models/Model',
  'shared/models/BaseCollection'
], function (_, Model, BaseCollection) {

  var M = Model.extend({

    extraProperties: /^_(links|embedded)\./,

    props: {
      'id'                    : 'string',
      'created'               : 'string',
      'lastUpdated'           : 'string',
      'lastMembershipUpdated' : 'string',
      'objectClass'           : 'array',
      'type'                  : 'string',
      'profile.name'          : 'string',
      'profile.description'   : 'string'
    },

    urlRoot: '/api/v1/groups/',

    getMediumLogo: function () {
      return this.get('_links.logo')[0]['href'];
    }
  });

  var C = BaseCollection.extend({
    model: M,
    url: '/api/v1/groups/',

    fetchByGroupIds: function (groupIds) {
      groupIds || (groupIds = []);

      var filter = _.chain(groupIds)
                    .map(function (id) { return 'id eq "' + id + '"'; })
                    .join(' or ')
                    .value();
      return this.fetch({data: {expand: 'stats,app', filter: filter}});
    }
  });

  return {
    Model: M,
    Collection: C
  };

});
