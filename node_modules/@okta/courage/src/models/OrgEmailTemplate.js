define([
  'underscore', './BaseModel', 'shared/util/LegacyController'
], function (_, BaseModel, LegacyController) {

  return BaseModel.extend({
    defaults : {
      template : undefined,
      subject : undefined,
      email : undefined,
      emailHtml : undefined
    },

    urlRootSave : '/admin/settings/email-post',
    urlRootLoad : '/admin/settings/email',

    sync : function (method, model, options) {
      if (method === 'read') {
        return LegacyController.get(_.extend(options, {
          url : this.urlRootLoad,
          data : {
            template : this.get('template'),
            json : true
          }
        }));
      } else {
        return LegacyController.post(_.extend(options, {
          url : this.urlRootSave,
          data : this,
          xsrfToken : this.get('__xsrfToken__')
        }));
      }
    },

    parse : function (resp) {
      // the save method returns the values in an object called data
      return resp.data || resp;
    }
  });
});
