define(['shared/models/BaseCollection', 'shared/models/BaseModel'], function (BaseCollection, BaseModel) {

  var url = '/api/v1/users';

  var User = BaseModel.extend({
    flat: true,
    urlRoot: url,

    url: function () {
      // backwards compatible
      var link = BaseModel.prototype.url.apply(this, arguments);
      return link + (this.get('__activateUser__') === false ? '?activate=false' : '');
    },

    '__nestedProperty__': 'profile.',

    isNew: function () {
      return !this.id || this.id == 'me';
    },

    defaults: {
      name: function () {
        return this.get('profile.firstName') + ' ' + this.get('profile.lastName');
      }
    }

  });

  var Users = BaseCollection.extend({
    model: User,
    url: url
  });

  /**
  * @class User
  *
  * Okta user(s)
  */
  return {
    Model: User,
    Collection: Users
  };

});
