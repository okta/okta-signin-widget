var execSync  = require('child_process').execSync,
    logger    = require('winston');

logger.cli();

module.exports = function (cmd, cwd, pipe) {
  var options = { encoding: 'utf8' },
      res;

  if (cwd) {
    options.cwd = cwd;
  }
  if (!pipe) {
    options.stdio = 'inherit';
  }

  // Uses process npm in case the target module has npm in its bin
  cmd = cmd.replace(/^npm /i, `${process.env.npm_execpath} `);

  logger.info(`Executing: "${cmd}"`, options);
  res = execSync(cmd, options);
  return res;
};
